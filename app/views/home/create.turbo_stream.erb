<%= turbo_stream.prepend "task-list" do %>
  <li id="<%= dom_id(@task) %>" class="flex justify-between items-center bg-gray-100 px-4 py-3">
    <div class="task-item">
      <%= form_with model: @task, url: toggle_status_task_path(@task), method: :patch, data: { turbo_stream: true } do |form| %>
        <%= form.check_box :status, {
          checked: @task.status,
          class: "task-checkbox",
          id: "task_#{@task.id}",
          onchange: "this.form.requestSubmit()",
          data: { testid: "checkbox-quest-#{@task.id}" }
        } %>
      <% end %>
      <div class="txt-btn">
        <label for="task_<%= @task.id %>" class="text-base md:text-lg break-words whitespace-normal overflow-hidden">
          <%= @task.content %>
        </label>
        <%= button_to task_path(@task), method: :delete, form: { data: { turbo_stream: true } }, class: "group bg-transparent p-0 border-0" do %>
          <%= image_tag "delete.svg", alt: "Delete", class: "delete-btn" %>
        <% end %>
      </div>
    </div>
  </li>
<% end %>

<%= turbo_stream.update "task-form" do %>
  <%= form_with model: Task.new, url: tasks_path, method: :post, data: { turbo_stream: true }, class: "flex flex-col md:flex-row md:items-start md:gap-4 mb-6" do |form| %>
    <div class="w-full md:flex-1 flex flex-col">
      <%= form.text_field :content, placeholder: "เพิ่มเควสต์ของฉัน", class: "task-input" %>
    </div>
    <div class="add-btn">
      <%= button_tag type: "submit", class: "bg-green-600 text-white p-3 rounded hover:bg-green-700 w-full md:w-auto mt-2 md:mt-0 flex items-center justify-center", data: { testid: "submit-quest" } do %>
        <%= image_tag "add_task.svg", alt: "เพิ่ม", class: "task-btn" %>
      <% end %>
    </div>
  <% end %>
<% end %>